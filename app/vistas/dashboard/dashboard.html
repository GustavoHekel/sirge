<div class="container-fluid">
	<div id="dashboard">
		<div class="row-fluid">
			<div class="responsive span3" data-tablet="span6" data-desktop="span3">
				<div id="dashboard-prestaciones" class="dashboard-stat blue">
					<div class="visual">
						<i class="icon-stethoscope"></i>
					</div>
					<div class="details">
						<div class="number">{TOTAL_PRESTACIONES}</div>
						<div class="desc">Prestaciones reportadas</div>
					</div>
					<a class="more" indicador="1" method="DetalleTotalesDB" href="#">Ver detalles<i class="m-icon-swapright m-icon-white"></i></a>
				</div>
			</div>
			<div class="responsive span3" data-tablet="span6" data-desktop="span3">
				<div id="dashboard-efectores" class="dashboard-stat red">
					<div class="visual">
						<i class="icon-hospital"></i>
					</div>
					<div class="details">
						<div class="number">{TOTAL_EFECTORES}</div>
						<div class="desc">Efectores</div>
					</div>
					<a class="more" indicador="2" method="DetalleTotalesDB" href="#">Ver detalles<i class="m-icon-swapright m-icon-white"></i></a>
				</div>
			</div>
			
			<div class="responsive span3" data-tablet="span6  fix-offset" data-desktop="span3">
				<div id="dashboard-beneficiarios" class="dashboard-stat yellow">
					<div class="visual">
						<i class="icon-group"></i>
					</div>
					<div class="details">
						<div class="number">{TOTAL_BENEFICIARIOS}</div>
						<div class="desc">Beneficiarios</div>
					</div>
					<a class="more" indicador="3" method="DetalleTotalesDB" href="#">Ver detalles<i class="m-icon-swapright m-icon-white"></i></a>
				</div>
			</div>
			
			<div class="responsive span3" data-tablet="span6" data-desktop="span3">
				<div id="dashboard-usuarios" class="dashboard-stat purple">
					<div class="visual">
						<i class="icon-user"></i>
					</div>
					<div class="details">
						<div class="number">{TOTAL_USUARIOS}</div>
						<div class="desc">Usuarios</div>
					</div>
					<a class="more" indicador="4" method="DetalleTotalesDB" href="#">Ver detalles<i class="m-icon-swapright m-icon-white"></i></a>
				</div>
			</div>
		</div>
		<div class="row-fluid">
			<div class="span6">
				<div class="portlet box blue">
					<div class="portlet-title">
						<div class="caption"><i class="icon-dashboard"></i>Estado de reporte de SIRGE per&iacute;odo {PERIODO} </div>
					</div>
					<div class="portlet-body">
						<div class="row-fluid">
							<div class="span4">
								<div class="easy-pie-chart">
									<div class="number easyPieChart porcentaje-prestaciones" data-percent="{ESTADO_PRESTACIONES}" style="width: 75px; height: 75px; line-height: 75px;"><span>{ESTADO_PRESTACIONES}</span>%<canvas width="75" height="75"></canvas></div>
									<a class="title" indicador="1" method="DetalleFuenteDatosDB" href="#">Prestaciones <i class="m-icon-swapright"></i></a>
								</div>
							</div>
							<div class="span4">
								<div class="easy-pie-chart">
									<div class="number easyPieChart porcentaje-comprobantes" data-percent="{ESTADO_COMPROBANTES}" style="width: 75px; height: 75px; line-height: 75px;"><span>{ESTADO_COMPROBANTES}</span>%<canvas width="75" height="75"></canvas></div>
									<a class="title" indicador="3" method="DetalleFuenteDatosDB" href="#">Comprobantes <i class="m-icon-swapright"></i></a>
								</div>
							</div>
							<div class="span4">
								<div class="easy-pie-chart">
									<div class="number easyPieChart porcentaje-fondos" data-percent="{ESTADO_FONDOS}" style="width: 75px; height: 75px; line-height: 75px;"><span>{ESTADO_FONDOS}</span>%<canvas width="75" height="75"></canvas></div>
									<a class="title" indicador="2" method="DetalleFuenteDatosDB" href="#">Uso de Fondos <i class="m-icon-swapright"></i></a>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="span3">
				<div class="portlet box red">
					<div class="portlet-title">
						<div class="caption"><i class="icon-dashboard"></i>P.U.C.O. {PERIODO}</div>
					</div>
					<div class="portlet-body">
						<div class="row-fluid">
							<div class="span3"></div>
							<div class="span6">
								<div class="easy-pie-chart">
									<div class="number easyPieChart" data-percent="{ESTADO_PUCO}" style="width: 75px; height: 75px; line-height: 75px;"><span>{ESTADO_PUCO}</span>%<canvas width="75" height="75"></canvas></div>
									<a class="title" indicador="1" method="DetallePUCODB" href="#">Info <i class="m-icon-swapright"></i></a>
								</div>
							</div>
							<div class="span3"></div>
						</div>
					</div>
				</div>
			</div>
			<div class="span3">
				<div class="portlet box purple">
					<div class="portlet-title">
						<div class="caption"><i class="icon-bar-chart"></i>Visitas mensuales</div>
					</div>
					<div class="portlet-body">
						<div class="row-fluid" id="sparkline-visitas">
							<div class="span2"></div>
							<div class="span6">
								<div class="sparkline-chart">
									<div class="number" id="sparkline_bar" style="heigth: 50px;">{CANTIDAD_VISITAS}</div>
									<a class="title" indicador="1" method="DetalleVisitasDB" href="#">Visitas <i class="m-icon-swapright"></i></a>
								</div>
							</div>
							<div class="span2"></div>
						</div>
					</div>
				</div>
			</div>
		</div>
		<div class="row-fluid">
			<div class="span6">
				<div class="portlet box green">
					<div class="portlet-title">
						<div class="caption"><i class="icon-globe"></i>Informaci&oacute;n r&aacute;pida</div>
					</div>
					<div class="portlet-body">
						<div id="map-container"></div>
					</div>
				</div>
			</div>
			<div class="span6">
				<div class="portlet box yellow">
					<div class="portlet-title">
						<div class="caption">
							<i class="icon-comments"></i>Comentarios
						</div>
					</div>
					<div class="portlet-body form">
						<form class="form-horizontal">
							<div class="control-group">
								<label class="control-label">Ingrese texto</label>
								<div class="controls">
									<input name="comentario" type="text" class="span10 m-wrap">
									<button id="enviar-comentario" class="btn green"><span class="icon-ok"></span></button>
								</div>
							</div>
						</form>
						<div id="contenedor-comentarios">{COMENTARIOS}
						</div>
					</div>
				</div>
			</div>
		</div>
		<div class="row-fluid">
			
		</div>
		<div class="row-fluid">
			<div class="span6">
				
			</div>
		</div>
		<div class="row-fluid">
			
		</div>
	</div>
</div>

<div style="display:none;">
	<div id="div-acumulado-sirge">
		
	</div>
	<table id="detalle-sirge" cellpadding="0" cellspacing="0" border="0" class="table table-striped table-bordered"></table>
	<table id="detalle-puco" cellpadding="0" cellspacing="0" border="0" class="table table-striped table-bordered"></table>
	<div id="detalle-provincia"></div>
</div>

<script type="text/javascript">
$(document).ready(function(){
	estilo_dialog ('yellow');
	mostrar_loading();
	
	$.gritter.removeAll();
	
	$('#sparkline_bar').sparkline ('html' , {
		height : 90 ,
		defaultPixelsPerValue : 20 ,
		lineColor : 'orange' ,
		chartRangeMin : 0
	});

	$('.easyPieChart').easyPieChart({
		animate : 1000 ,
		barColor : function(percent) {
			percent /= 100;
			return "rgb(" + Math.round(255 * (1-percent)) + ", " + Math.round(255 * percent) + ", 0)";
		}
	});
	
	$('#contenedor-comentarios').slimScroll({
		height: '346px' ,
		alwaysVisible: true ,
		railVisible: true ,
		color : '#0362fd'
	});
	
	function InfoProvincia () {
		mostrar_loading();
		var titulo = this.name;
		
		$.ajax({
			type : 'post',
			url	 : 'app/controladores/dashboard/informacion_provincia.php',
			data : 'provincia=' + titulo.toUpperCase(),
			success : function (data) {
				ocultar_loading();
				$('#detalle-provincia').html(data);
				$("#detalle-provincia").dialog({
					title : titulo ,
					buttons : [{
						text : 'Aceptar' ,
						class : 'btn green' ,
						click : function () {$(this).dialog('close')}
					}]
				});
			}
		});
	}
	
	$.ajax({
		type 		: 'post',
		url  		: 'app/parserAjax.php',
		data 		: {
			c 	: 'Geo',
			m 	: 'DashboardMap'
		},
		dataType 	: 'json',
		success 	: function (geo) {
			$('#map-container').highcharts('Map', {
				title : {
					text : 'Poblaci贸n'
				},
				mapNavigation: {
					enabled: true,
					buttonOptions: {
						verticalAlign: 'bottom'
					}
				},
				colorAxis: {
					min: 0
				},
				series : [{
					data : geo,
					mapData: Highcharts.maps['countries/ar/ar-all'],
					joinBy: 'hc-key',
					name: 'Poblaci贸n',
					states: {
						hover: {
							color: '#BADA55'
						}
					},
					dataLabels: {
						enabled: false,
						format: '{point.name}'
					},
					point : {
						events : {
							click : InfoProvincia
						}
					},
					cursor : 'pointer'
				}]
			});
		}
	});
	
	ocultar_loading();
	
	function DetalleIndicador (metodo , id_indicador) {
		mostrar_loading();
		$.ajax({
			type 		: 'post' ,
			url  		: 'app/parserAjax.php' ,
			data 		: {
				c : 'SIRGe' ,
				m : metodo ,
				p : 'id_fuente=' + id_indicador
			} ,
			dataType 	: 'json' ,
			success 	: function (data) {
				$('#div-acumulado-sirge').empty();
				$('#div-acumulado-sirge').html('<table id="acumulado-sirge" cellpadding="0" cellspacing="0" border="0" class="table table-striped table-bordered"></table>');
				$('#acumulado-sirge').dataTable({
					"sDom"		: 'T<"clear">frt<"bottom"lp><"clear">' ,
					"aaData"	: data['data'] ,
					"aoColumns"	: data['aoColumns'] ,
					"bDestroy" 	: true ,
				})
			} ,
			complete	: function () {
				ocultar_loading();
				$('#div-acumulado-sirge').dialog({
					title 	: 'Informaci贸n por jurisdicci贸n' ,
					width 	: 'auto' ,
					buttons : [{
						text  : 'Aceptar' ,
						class : 'btn green' ,
						click : function () {
							$(this).dialog('close')
						}
					}]
				});
			}
		});
	}
	
	$('.more , .title').click(function(){
		
		DetalleIndicador($(this).attr('method') , $(this).attr('indicador'));
		
	});
	
	$('#enviar-comentario').click(function(event){
		event.preventDefault();
		mostrar_loading ();

		$.ajax ({
			type 	: 'post' ,
			url  	: 'app/parserAjax.php' ,
			data 	: {
				c : 'SIRGe' ,
				m : 'InsertarComentarioDB' ,
				p : $('form').serialize()
			} ,
			success : function (data) {
				$('#contenedor-comentarios').empty().html(data);
				$('.form-horizontal')[0].reset();
				ocultar_loading();
			}
		});
	});
	
	{NOTIFICACION_SIRGE}
	{NOTIFICACION_DOIU9}
	
	
	/*$.gritter.add({
		title : 'Atenci&oacute;n!' ,
		text : 'Recuerde presentar la DDJJ de informaci&oacute;n priorizada del mes en curso' ,
		sticky : true 
	});
	*/
	/*
	
	$.when(
		ajax_indicador ('usuarios') ,
		ajax_indicador ('transferencias') ,
		ajax_indicador ('visitas') ,
		ajax_indicador ('efectores') ,
		ajax_indicador ('prestaciones') ,
		ajax_indicador ('porcentajes') , 
		ajax_indicador ('doiu') ,
		ajax_indicador ('padrones')
	).then(function(a1 , a2 , a3 , a4 , a5 , a6 , a7 , a8){
		armar_numero ('#dashboard-usuarios .number' , a1);
		armar_numero ('#dashboard-transferencias .number' , a2);
		armar_sparkline ('#sparkline_bar' , JSON.parse (a3[0]));
		armar_numero ('#dashboard-efectores .number' , a4);
		armar_numero ('#dashboard-prestaciones .number' , a5);
		armar_porcentaje ('.porcentaje-puco' , JSON.parse(a6[0]) , 0);
		armar_porcentaje ('.porcentaje-prestaciones' , JSON.parse(a6[0]) , 1);
		armar_porcentaje ('.porcentaje-comprobantes' , JSON.parse(a6[0]) , 2);
		armar_porcentaje ('.porcentaje-fondos' , JSON.parse(a6[0]) , 3);
		pie_chart ();
		armar_comentarios ();
		
		var data = JSON.parse (a7[0]);
		if (data[0]['dias_restantes'] != '9999' && data[0]['informe'] == 0) {
			notificacion_doiu (data[0]['informe']);
			console.log (data);
		}
		
		var padrones = JSON.parse (a8[0]);
		console.log (padrones);
		if (padrones[0]['dias'] != '9999') {
			notificacion_padron (padrones[0]['id_padron'] , padrones[0]['dias'] , padrones[0]['grupo']);
			notificacion_padron (padrones[1]['id_padron'] , padrones[1]['dias'] , padrones[0]['grupo']);
			notificacion_padron (padrones[2]['id_padron'] , padrones[2]['dias'] , padrones[0]['grupo']);
		}
		
		ocultar_loading();

	} , function () {
		alert ("Error!");
	});
	
	function notificacion_doiu (informe) {
		$.gritter.add({
			title : 'Atenci&oacute;n!' ,
			text : 'Recuerde presentar la DDJJ de informaci&oacute;n priorizada del mes en curso' ,
			sticky : true 
		});
	}
	
	function notificacion_padron (padron , dias , grupo) {
		switch (padron) {
			case '1' : 
				var texto = 'No se registran lotes informados de prestaciones hace ' + dias + ' dias' ; 
				var titulo = 'Prestaciones' ;
				break;
			case '2' : 
				var texto = 'No se registran lotes informados de aplicaci&oacute;n de fondos hace ' + dias + ' dias' ; 
				var titulo = 'Aplicaci&oacute;n de fondos';
				break;
			case '3' : 
				var texto = 'No se registran lotes informados de comprobantes hace ' + dias + ' dias' ; 
				var titulo = 'Comprobantes';
				break;
		}
		
		
		if (dias >= 30 && grupo != 25) {
			$.gritter.add({
				title : titulo ,
				text : texto ,
				sticky : true
			});
		} else {
			//console.log (dias);
		}
	}
	*/
});
</script>

